<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Open Tamper Options</title>
    <script type="module" src="../common/theme.js"></script>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <main class="container">
      <header>
        <h1>Open Tamper</h1>
        <p class="subtitle">
          Add remote userscripts from raw GitHub URLs and manage where they run.
        </p>
      </header>

      <section id="userscripts-warning" class="warning" hidden>
        <h2>User Script Support Disabled</h2>
        <p>
          Chrome’s <code>chrome.userScripts</code> API is not available. Scripts
          will not auto-run until you enable the “Enable extension manifest V3
          user scripts API” flag at
          <code>chrome://flags/#extension-user-scripts</code>
          (Chrome 120+) and restart the browser.
        </p>
      </section>

      <section class="add-script">
        <h2>Add Script</h2>
        <form id="add-script-form">
          <label for="script-url">Raw GitHub URL or Repository</label>
          <input
            id="script-url"
            type="url"
            placeholder="https://raw.githubusercontent.com/..."
            required
          />
          <div class="add-actions">
            <button type="submit">Fetch &amp; Save</button>
            <button type="button" id="import-from-file">
              Import Local Script
            </button>
            <button type="button" id="import-as-require">
              Import Local As @require
            </button>
          </div>
        </form>
        <input
          id="script-file"
          type="file"
          accept=".user.js,.js,text/javascript"
          hidden
        />
        <p class="hint">
          The script should include a standard userscript metadata block with
          @match entries. Local files require "Allow access to file URLs" for
          this extension.
        </p>
      </section>

      <section class="repo-import" id="repo-import" hidden>
        <h2>Repository Userscripts</h2>
        <p id="repo-import-summary" class="hint"></p>
        <div id="repo-import-list"></div>
        <template id="repo-import-row">
          <article class="repo-script">
            <div class="repo-script__details">
              <h3 class="repo-script__name"></h3>
              <p class="repo-script__path"></p>
            </div>
            <button type="button" class="repo-script__import">Import</button>
          </article>
        </template>
        <p id="repo-import-empty" class="empty">No userscripts found.</p>
      </section>

      <section class="scripts-list">
        <h2>Installed Scripts</h2>
        <div id="scripts"></div>
        <template id="script-row">
          <article class="script">
            <div class="script__header">
              <div class="script__title">
                <h3 class="script__name"></h3>
                <p class="script__description"></p>
              </div>
              <label class="switch">
                <input type="checkbox" class="script__toggle" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="script__tags"></div>
            <div class="script__meta"></div>
            <div class="script__routing">
              <div class="script__matches"></div>
              <div class="script__frames"></div>
            </div>
            <div class="script__requires"></div>
            <div class="script__footer">
              <div class="script__actions">
                <button class="refresh">Refresh</button>
                <button class="remove">Remove</button>
              </div>
              <label class="script__autoupdate" hidden>
                <input type="checkbox" class="script__autoupdate-toggle" />
                <span>Auto-update</span>
              </label>
            </div>
          </article>
        </template>
        <p id="empty-state" class="empty">No scripts added yet.</p>
      </section>

      <section class="settings">
        <h2>Settings</h2>
        <div class="settings__group">
          <h3>Badge Colors</h3>
          <p class="hint">Customize the extension badge that shows the number of active scripts on each tab.</p>
          <div class="settings__row">
            <label for="badge-text-color">Text Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="badge-text-color" value="#000000" />
              <input type="text" id="badge-text-color-hex" class="color-hex-input" value="#000000" maxlength="7" />
            </div>
          </div>
          <div class="settings__row">
            <label for="badge-bg-color">Background Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="badge-bg-color" value="#4CAF50" />
              <input type="text" id="badge-bg-color-hex" class="color-hex-input" value="#4CAF50" maxlength="7" />
            </div>
          </div>
          <div class="badge-preview">
            <span class="badge-preview__label">Preview:</span>
            <span id="badge-preview" class="badge-preview__badge">3</span>
          </div>
        </div>
      </section>

      <section class="log" hidden>
        <h2>Log</h2>
        <pre id="log-output"></pre>
      </section>
    </main>
    <script type="module" src="options.js"></script>
  </body>
</html>
